sudo: false
language: android
jdk: [oraclejdk8]
before_install: [yes | sdkmanager tools, yes | sdkmanager "system-images;android-18;default;armeabi-v7a",
  echo no | avdmanager create avd --force -n test -k "system-images;android-18;default;armeabi-v7a",
  $ANDROID_HOME/emulator/emulator -avd test -no-audio -no-window &]
install: ./gradlew clean assemble assembleAndroidTest --stacktrace
before_script: [android-wait-for-emulator, adb shell input keyevent 82]
script: ./gradlew check connectedCheck -x :tests:DaoTestPerformance:connectedCheck
  --stacktrace
before_cache: [rm -f  $HOME/.gradle/caches/modules-2/modules-2.lock, rm -fr $HOME/.gradle/caches/*/plugin-resolution/]
cache:
  directories: [$HOME/.gradle/caches/, $HOME/.gradle/wrapper/, $HOME/.android/build-cache]
branches:
  only: [greenrobot/greenDAO-1091-CACHING]
